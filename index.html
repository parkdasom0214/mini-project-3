<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>오픈마켓</title>

    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <header id="header"></header>

    <section class="top-banner" aria-label="상단 배너 영역">
      <button class="arrow left">&#10094;</button>
      <button class="arrow right">&#10095;</button>

      <div class="indicators">
        <span class="dot active"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
    </section>

    <main>
      <section class="product-list" id="product-list">
        <!-- JS로 상품 카드가 여기에 채워질 예정 -->
      </section>
    </main>

    <footer id="footer"></footer>

    <!-- api 연동 -->
    <!-- 이 코드로 HTML 안의 API fetch 부분을 완전히 교체하세요 -->

    <script>
      // 상품 API의 기본 URL 설정
      const baseUrl = "https://api.wenivops.co.kr/services/open-market/";

      // 'products' 엔드포인트로 GET 요청
      fetch(`${baseUrl}products`)
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          console.log(data);

          // product-list 섹션을 선택
          const productList = document.querySelector("#product-list");

          if (!productList) {
            console.error("product-list 요소를 찾을 수 없습니다!");
            return;
          }

          // 받아온 상품 리스트를 하나씩 순회
          data["results"].forEach((product) => {
            // 각 상품을 담을 div 요소 생성
            const productCard = document.createElement("div");
            productCard.className = "product-card";

            // 상품 정보를 카드 형태로 작성
            productCard.innerHTML = `
          <div class="product-image">
            <img src="${product.image}" alt="${product.name}">
          </div>
          <div class="product-info">
            <h3 class="product-name">${product.name}</h3>
            <p class="product-price">${product.price.toLocaleString()}원</p>
          </div>
        `;

            // 생성한 상품 카드를 product-list 섹션에 추가
            productList.appendChild(productCard);
          });
        })
        .catch((error) => {
          console.error(
            "There has been a problem with your fetch operation:",
            error
          );
        });
    </script>

    <script>
      // DOM이 완전히 로드된 후 실행
      document.addEventListener("DOMContentLoaded", function () {
        // 헤더 로드
        fetch("header.html")
          .then((response) => response.text())
          .then((html) => (document.getElementById("header").innerHTML = html));

        // 푸터 로드
        fetch("footer.html")
          .then((response) => response.text())
          .then((html) => (document.getElementById("footer").innerHTML = html));
      });
    </script>
  </body>
</html>
