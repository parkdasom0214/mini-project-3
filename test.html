// header.js - ë“œë¡­ë‹¤ìš´ì´ í†µí•©ëœ ì™„ì „í•œ í—¤ë” í…œí”Œë¦¿ // í—¤ë” í…œí”Œë¦¿ ìƒì„± í•¨ìˆ˜
function createHeaderTemplate(options = {}) { const config = { logoText: 'í˜¸ë‘
ì˜¤í”ˆë§ˆì¼“', logoImage: `${getBasePath()}/images/logo-hodu.png`, logoUrl:
`${getBasePath()}/index.html`, searchAction: '/search', searchPlaceholder:
'ìƒí’ˆì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”', cartUrl: '#', cartText: 'ì¥ë°”êµ¬ë‹ˆ', cartIcon:
`${getBasePath()}/images/icon-shopping-cart.svg`, loginUrl:
`${getBasePath()}/login.html`, loginText: 'ë§ˆì´í˜ì´ì§€', loginIcon:
`${getBasePath()}/images/icon-user.svg`, }; return `
<div class="container">
  <h1>
    <a href="${config.logoUrl}"
      ><img src="${config.logoImage}" alt="${config.logoText}"
    /></a>
  </h1>
  <form action="${config.searchAction}" method="GET" role="search">
    <label for="search" class="visually-hidden">ìƒí’ˆ ê²€ìƒ‰</label>
    <input
      type="text"
      id="search"
      name="q"
      placeholder="${config.searchPlaceholder}"
    />
    <button type="submit">ê²€ìƒ‰</button>
  </form>
  <nav class="user-menu">
    <a href="${config.cartUrl}" class="cart">
      <img src="${config.cartIcon}" alt="" />${config.cartText}
    </a>
    <div class="login-container">
      <a href="${config.loginUrl}" class="login">
        <img src="${config.loginIcon}" alt="" />${config.loginText}
      </a>
      <div class="dropdown-menu">
        <div class="dropdown-item" data-action="mypage">
          <span class="dropdown-text">ë§ˆì´í˜ì´ì§€</span>
        </div>
        <div class="dropdown-item" data-action="logout">
          <span class="dropdown-text">ë¡œê·¸ì•„ì›ƒ</span>
        </div>
      </div>
    </div>
  </nav>
</div>
`; } // í—¤ë” í´ë˜ìŠ¤ class Header { constructor(options = {}) { this.options =
options; this.isLoggedIn = false; this.userData = null; this.dropdownMenu =
null; this.loginContainer = null; } // í—¤ë” ë Œë”ë§ render(targetSelector) {
const targetElement = typeof targetSelector === 'string' ?
document.querySelector(targetSelector) : targetSelector; if (!targetElement) {
console.error('í—¤ë”ë¥¼ ë Œë”ë§í•  ëŒ€ìƒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', targetSelector);
return; } targetElement.innerHTML = createHeaderTemplate(this.options);
this.addDropdownStyles(); this.bindEvents(targetElement);
this.initDropdown(targetElement); this.updateUserMenu(); } // ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼
ì¶”ê°€ addDropdownStyles() { if (document.getElementById('dropdown-styles')) {
return; } const style = document.createElement('style'); style.id =
'dropdown-styles'; style.textContent = ` /* í—¤ë” ì»¨í…Œì´ë„ˆ ë ˆì´ì•„ì›ƒ */ .container
{ display: flex; align-items: center; gap: 30px; max-width: 1200px; margin: 0
auto; padding: 0 20px; } .container h1 { flex-shrink: 0; } /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
form[role="search"] { position: relative; display: flex; align-items: center;
flex: 1; max-width: 400px; } .user-menu { flex-shrink: 0; margin-left: auto; }
#search { width: 100%; padding: 12px 50px 12px 20px; border: 2px solid #21C55D;
border-radius: 50px; font-size: 16px; outline: none; background: white; color:
#666; } #search::placeholder { color: #21C55D; font-weight: 400; } #search:focus
{ border-color: #16A34A; box-shadow: 0 0 0 3px rgba(33, 197, 93, 0.1); }
form[role="search"] button { position: absolute; right: 8px; top: 50%;
transform: translateY(-50%); background: #21C55D; border: none; border-radius:
50%; width: 36px; height: 36px; display: flex; align-items: center;
justify-content: center; cursor: pointer; transition: background-color 0.2s; }
form[role="search"] button:hover { background: #16A34A; } form[role="search"]
button::before { content: "ğŸ”"; font-size: 16px; color: white; }
.login-container { position: relative; display: inline-block; } .dropdown-menu {
position: absolute; top: 100%; right: 0; background: white; border: 1px solid
#e0e0e0; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
min-width: 150px; z-index: 1000; opacity: 0; transform: translateY(-10px);
transition: all 0.2s ease; pointer-events: none; display: none; }
.dropdown-menu.show { opacity: 1; transform: translateY(0); pointer-events:
auto; display: block !important; } .dropdown-item { display: flex; align-items:
center; gap: 10px; padding: 12px 16px; cursor: pointer; transition:
background-color 0.2s; border-bottom: 1px solid #f0f0f0; }
.dropdown-item:last-child { border-bottom: none; } .dropdown-item:hover {
background-color: #f8f9fa; } .dropdown-icon { font-size: 16px; } .dropdown-text
{ font-size: 14px; color: #333; font-weight: 500; } .dropdown-item:hover
.dropdown-text { color: #4CAF50; } .login-container.active .login {
background-color: #f0f8ff; border-radius: 4px; } /* ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ ë“œë¡­ë‹¤ìš´
í‘œì‹œ */ .login-container:not(.logged-in) .dropdown-menu { display: none
!important; } `; document.head.appendChild(style); } // ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
initDropdown(container) { this.loginContainer =
container.querySelector('.login-container'); this.dropdownMenu =
container.querySelector('.dropdown-menu'); if (!this.loginContainer ||
!this.dropdownMenu) { return; } // ë“œë¡­ë‹¤ìš´ ì´ë²¤íŠ¸ ë°”ì¸ë”©
this.bindDropdownEvents(); } // ë“œë¡­ë‹¤ìš´ ì´ë²¤íŠ¸ ë°”ì¸ë”© bindDropdownEvents() { if
(!this.loginContainer || !this.dropdownMenu) { return; } // ë¡œê·¸ì¸ ë§í¬ í´ë¦­ ì‹œ
ë“œë¡­ë‹¤ìš´ í† ê¸€ (ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ) const loginLink =
this.loginContainer.querySelector('.login'); loginLink.addEventListener('click',
(e) => { if (this.isLoggedIn) { e.preventDefault(); e.stopPropagation();
this.toggleDropdown(); } else { this.onLoginClick(e); } }); // ë“œë¡­ë‹¤ìš´ ë©”ë‰´
ì•„ì´í…œ í´ë¦­ ì´ë²¤íŠ¸ this.dropdownMenu.addEventListener('click', (e) => {
e.stopPropagation(); const item = e.target.closest('.dropdown-item'); if (item)
{ const action = item.getAttribute('data-action');
this.handleDropdownAction(action); this.hideDropdown(); } }); // ì™¸ë¶€ í´ë¦­ ì‹œ
ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ document.addEventListener('click', (e) => { if
(this.loginContainer && !this.loginContainer.contains(e.target)) {
this.hideDropdown(); } }); // ESC í‚¤ë¡œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
document.addEventListener('keydown', (e) => { if (e.key === 'Escape') {
this.hideDropdown(); } }); } // ë“œë¡­ë‹¤ìš´ í† ê¸€ toggleDropdown() { if
(!this.isLoggedIn) return; if (this.dropdownMenu.classList.contains('show')) {
this.hideDropdown(); } else { this.showDropdown(); } } // ë“œë¡­ë‹¤ìš´ í‘œì‹œ
showDropdown() { if (!this.isLoggedIn) return; this.dropdownMenu.style.display =
'block'; setTimeout(() => { this.dropdownMenu.classList.add('show'); }, 10);
this.loginContainer.classList.add('active'); } // ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ hideDropdown() {
this.dropdownMenu.classList.remove('show');
this.loginContainer.classList.remove('active'); setTimeout(() => { if
(!this.dropdownMenu.classList.contains('show')) {
this.dropdownMenu.style.display = 'none'; } }, 200); } // ë“œë¡­ë‹¤ìš´ ì•¡ì…˜ ì²˜ë¦¬
handleDropdownAction(action) { switch (action) { case 'mypage':
window.location.href = this.options.mypageUrl || './mypage.html'; break; case
'logout': this.handleLogout(); break; default: console.log('ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜:',
action); } } // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ handleLogout() { if (confirm('ë¡œê·¸ì•„ì›ƒ
í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { this.logout(); alert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
window.location.href = this.options.loginUrl || './login.html'; } } // ì´ë²¤íŠ¸
ë°”ì¸ë”© bindEvents(container) { // ê²€ìƒ‰ í¼ ì´ë²¤íŠ¸ const searchForm =
container.querySelector('form[role="search"]'); const searchInput =
container.querySelector('#search'); if (searchForm) {
searchForm.addEventListener('submit', (e) => { const query =
searchInput.value.trim(); if (!query) { e.preventDefault(); alert('ê²€ìƒ‰ì–´ë¥¼
ì…ë ¥í•´ì£¼ì„¸ìš”.'); searchInput.focus(); return; } this.onSearch(query, e); }); }
// ì¥ë°”êµ¬ë‹ˆ í´ë¦­ ì´ë²¤íŠ¸ const cartLink = container.querySelector('.cart'); if
(cartLink) { cartLink.addEventListener('click', (e) => { if
(cartLink.getAttribute('href') === '#') { e.preventDefault(); }
this.onCartClick(e); }); } // ë¡œê³  í´ë¦­ ì´ë²¤íŠ¸ const logoLink =
container.querySelector('h1 a'); if (logoLink) {
logoLink.addEventListener('click', (e) => { this.onLogoClick(e); }); } } // ê²€ìƒ‰
ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ onSearch(query, event) { console.log('ê²€ìƒ‰:', query); } //
ì¥ë°”êµ¬ë‹ˆ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ onCartClick(event) { if (!this.isLoggedIn) {
event.preventDefault(); alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
window.location.href = this.options.loginUrl || './login.html'; return; } if
(event.target.closest('a').getAttribute('href') === '#') { alert('ì¥ë°”êµ¬ë‹ˆ
ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); } } // ë¡œê·¸ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸
updateLoginStatus(isLoggedIn, userData = null) { this.isLoggedIn = isLoggedIn;
this.userData = userData; this.updateUserMenu(); } // ì‚¬ìš©ì ë©”ë‰´ ì—…ë°ì´íŠ¸
(ëˆ„ë½ëœ ë¶€ë¶„ ì™„ì„±) updateUserMenu() { const loginLink =
document.querySelector('.login'); const loginContainer =
document.querySelector('.login-container'); if (!loginLink || !loginContainer)
return; if (this.isLoggedIn && this.userData) { // ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ
loginContainer.classList.add('logged-in'); loginLink.querySelector('span') ?
loginLink.querySelector('span').textContent = this.userData.name || 'ë§ˆì´í˜ì´ì§€'
: loginLink.innerHTML += `<span>${this.userData.name || 'ë§ˆì´í˜ì´ì§€'}</span>`; }
else { // ë¡œê·¸ì•„ì›ƒ ìƒíƒœì¼ ë•Œ loginContainer.classList.remove('logged-in'); const
span = loginLink.querySelector('span'); if (span) span.textContent =
'ë§ˆì´í˜ì´ì§€'; } } // ë¡œê·¸ì¸/ë§ˆì´í˜ì´ì§€ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ onLoginClick(event) {
console.log('ë¡œê·¸ì¸/ë§ˆì´í˜ì´ì§€ í´ë¦­'); } // ë¡œê³  í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
onLogoClick(event) { console.log('ë¡œê³  í´ë¦­'); } // ë¡œê·¸ì•„ì›ƒ logout() {
this.isLoggedIn = false; this.userData = null; this.updateUserMenu(); // ë¡œì»¬
ìŠ¤í† ë¦¬ì§€ì—ì„œ ì¸ì¦ ì •ë³´ ì œê±° localStorage.removeItem('authToken');
localStorage.removeItem('userData'); localStorage.removeItem('userType'); } } //
ìë™ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ function checkAutoLogin() { try { const token =
localStorage.getItem('authToken'); const userData =
localStorage.getItem('userData'); if (token && userData) { const parsedUserData
= JSON.parse(userData); updateHeaderLoginStatus(true, parsedUserData); return
true; } } catch (error) { console.error('ìë™ ë¡œê·¸ì¸ í™•ì¸ ì¤‘ ì˜¤ë¥˜:', error); }
return false; } // ê°„í¸ ì‚¬ìš©ì„ ìœ„í•œ ì „ì—­ í•¨ìˆ˜ë“¤ let globalHeader = null; // í—¤ë”
ì´ˆê¸°í™” (ê°€ì¥ ê°„ë‹¨í•œ ì‚¬ìš©ë²•) function initHeader(targetSelector, options = {}) {
globalHeader = new Header(options); if (document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', () => {
globalHeader.render(targetSelector); }); } else {
globalHeader.render(targetSelector); } return globalHeader; } // í—¤ë” ìƒì„± (ì˜µì…˜
í¬í•¨) function createHeader(targetSelector, options = {}) { return
initHeader(targetSelector, options); } // ë¡œê·¸ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì „ì—­ í•¨ìˆ˜)
function updateHeaderLoginStatus(isLoggedIn, userData = null) { if
(globalHeader) { globalHeader.updateLoginStatus(isLoggedIn, userData); } } //
ë¡œê·¸ì•„ì›ƒ (ì „ì—­ í•¨ìˆ˜) function headerLogout() { if (globalHeader) {
globalHeader.logout(); } } // ES6 ëª¨ë“ˆ ë°©ì‹ export (í•„ìš”ì‹œ) if (typeof module
!== 'undefined' && module.exports) { module.exports = { Header,
createHeaderTemplate, initHeader, createHeader, updateHeaderLoginStatus,
headerLogout, checkAutoLogin }; } // ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ ì „ì—­ ê°ì²´ì— ì¶”ê°€ if
(typeof window !== 'undefined') { window.Header = Header; window.initHeader =
initHeader; window.createHeader = createHeader; window.updateHeaderLoginStatus =
updateHeaderLoginStatus; window.headerLogout = headerLogout;
window.checkAutoLogin = checkAutoLogin; } function getBasePath() { const isLocal
= location.hostname === 'localhost' || location.hostname === '127.0.0.1'; return
isLocal ? '' : '/mini-project-3'; }
